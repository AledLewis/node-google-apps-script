#!/usr/bin/env node
var program = require('commander');
var path = require('path');
var pkg = require('../package.json');
var commands = path.join(__dirname, '../lib/commands');
var _ = require('lodash');

program
  .version(pkg.version);

program
  .command('auth <path/to/client/secret.json>')
  .option('-w, --use-webserver [webserver]',
    'Use a local webserver to capture oauth code')
  .option('-p, --port [port]', 'Port to use for webserver')
  .description('Authorize Google API')
  .action(function(clientSecretPath, options) {
    var useWebserver = options.useWebserver !== 'false';
    require(commands + '/auth')(clientSecretPath, useWebserver)
      .then(function() {
        process.exit(0);
      });
  });

program
  .command('deployment', 'Manage Apps Script deployments')
  .command('project', 'Manage Apps Script projects');

program
  .parse(process.argv);

if (program.args.length < 1 ) {
  console.log('No command specified.');
  program.outputHelp();
  process.exit(2);
}
